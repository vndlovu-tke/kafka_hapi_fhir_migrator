## Kafka to HAPI FHIR migration service

This service consumes data from hapi-migration and posts the bundles to hapi-fhir on a given server

The service does the following

1. connects to elastic-search
1. loops through the IDs generated by the clickhouse migration script
1. create a bundle to send to hapi fhir
1. Save processed IDs to a text file
1. Saves FHIR bundles that couldn't be posted to HAPI FHIR in a migration-errors Kafka topic

## Steps to run

- Build the image:

```
./build_image.sh
```

- Set the placement node in the `docker-compose.yml` file to the appropriate node.

- Deploy into `migration` stack:

```shell
docker stack deploy -c docker/docker-compose.yml
```
